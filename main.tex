\documentclass[12pt]{article}
\usepackage{amsmath}
\usepackage{graphicx,psfrag,epsf}
\usepackage{enumerate}
\usepackage{natbib}
\usepackage{url} % not crucial - just used below for the URL
\usepackage{subcaption}
\usepackage{booktabs}
\usepackage{hyperref}
\usepackage{float}
\usepackage{ulem}
\usepackage{xfrac}
%\pdfminorversion=4
% NOTE: To produce blinded version, replace "0" with "1" below.
\newcommand{\blind}{1}

\newcommand{\rulesep}{\unskip\ \vrule\ }

% line numbers
\usepackage{lineno}
\linenumbers

\usepackage{amsfonts}
\usepackage{wrapfig}
\newcommand{\Prob}{P}
\newcommand{\Expect}{\mathbb{E}}
\newcommand{\Reals}{\mathbb{R}}
\newcommand{\KL}{\textrm{KL}}

% DON'T change margins - should be 1 inch all around.
\addtolength{\oddsidemargin}{-.5in}%
\addtolength{\evensidemargin}{-.5in}%
\addtolength{\textwidth}{1in}%
\addtolength{\textheight}{-.3in}%
\addtolength{\topmargin}{-.8in}%

\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}

\usepackage{soul}
\usepackage[disable]{todonotes}
\newcommand{\jeff}[2][]{\todo[inline,color=blue!30, #1]{#2 \mbox{--Jeff}}}
\newcommand{\bryan}[2][]{\todo[inline,color=green!30, #1]{#2 \mbox{--Bryan}}}
 
\date{\vspace{-10px}}

\begin{document}

%\bibliographystyle{natbib}

\def\spacingset#1{\renewcommand{\baselinestretch}%
{#1}\small\normalsize} \spacingset{1}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Reweighted Wake-Sleep for Deblending Crowded Starfields
\if1\blind
{
  \title{  \vspace{-30px}
\bf Variational Inference for Deblending Crowded Starfields}
  \author{Runjing Liu
  \thanks{The author gratefully acknowledges support from the NSF graduate research fellowship program.  
  This paper has undergone internal review in the LSST Dark Energy Science Collaboration. 
  The internal reviewers were 
  Bastien Arcelin,
  Fran\c{c}ois Lanusse, and 
  Peter Melchior. 
  We would also like to acknowledge Derek Hansen, Ismael Mendoza, Zhe Zhao for their comments on this manuscript and dedicated work to our continued code development.
  }
  \hspace{.2cm}\\
    Department of Statistics, University of California, Berkeley\\
    \\
    Jon D. McAuliffe \\
    The Voleon Group \\
    Department of Statistics, University of California, Berkeley\\
    \\
    Jeffrey Regier \\
    Department of Statistics, University of Michigan\\
    \\
    The LSST Dark Energy Science Collaboration
    }
  \maketitle
} \fi

\if0\blind
{
  \bigskip
  \bigskip
  \bigskip
  \begin{center}
    {\LARGE\bf A Variational Inference Approach to Deblending Crowded Starfields using the Wake-sleep Algorithm}
\end{center}
  \medskip
} \fi

\bigskip
\begin{abstract}
In the image data collected by astronomical surveys, stars and galaxies often overlap.
Deblending is the task of distinguishing and characterizing individual light sources from survey images.
We propose StarNet, a fully Bayesian method to deblend sources in astronomical images of crowded star fields.
StarNet leverages recent advances in variational inference, including amortized variational distributions and the Wake-Sleep algorithm.
Wake-Sleep, which minimizes forward KL divergence, has significant benefits compared to traditional variational inference, which minimizes a reverse KL divergence.
In our experiments with SDSS images of the M2 globular cluster, StarNet is substantially more accurate than two competing methods: Probablistic Cataloging (PCAT), a method that uses MCMC for inference, and a software pipeline employed by SDSS for deblending (DAOPHOT).
In addition, StarNet is as much as $100,000$ times faster than PCAT, exhibiting the scaling characteristics necessary to perform fully Bayesian inference on modern astronomical surveys.

%Probabilistic cataloging defines a joint distribution on raw telescope images and their catalogs; ambiguities in catalog construction are captured by the Bayesian posterior.
% However, current probabilistic cataloging methods typically employ MCMC (Markov chain Monte Carlo), whose computational cost is prohibitive for the terabytes of data collected by modern astronomical surveys. 
%As an alternative, we propose StarNet, a method employing amortized variational inference.
%StarNet fits an approximate posterior using the wake-sleep algorithm. 
%Similar to variational EM (expectation maximization), the wake-sleep algorithm alternates between fitting approximate posteriors and estimating model parameters, such as the point spread function. 
%However, the wake-sleep algorithm  fits the approximate posterior by optimizing the  forward KL (Kullback-Leibler) divergence instead of the traditionally used reverse KL divergence.
% We find that the the wake-sleep algorithm produces more reliable catalogs by avoiding shallow local minima in the reverse KL. StarNet outperforms existing cataloging routines on the crowded starfield M2. In addition,  
% and provides a statistical framework producing a cataloging pipeline whereby uncertainties are fully propagated from raw image to catalog to downstream analysis. 

\end{abstract}

\noindent%
{\it Keywords:}  Bayesian methods, amortized inference, wake-sleep algorithm, approximate inference, astronomical surveys, cataloging. 
\vfill

\newpage
\spacingset{1.45} % DON'T change the spacing!
\section{Introduction}
\label{sec:intro}
\input{1-introduction}

\section{The generative model}
\label{sec:gen_model}
\input{2-generative_model}

\section{Variational inference}
\label{sec:var_inference}
\input{3-var_inference}

\section{The wake-sleep algorithm}
\label{sec:wake_sleep}
\input{4a-wake_sleep}
\input{4b-variational_em}
\input{4c-sleep_details}
% NO LONGER NEEDED
% \section{Related work}
% \label{sec:related_work}
% \input{4-related_work}

\section{Empirical comparison of ELBO optimization and sleep optimization}
\input{5-results-synth_data}
% \input{5b-results-deblending}

\section{Results on the M2 globular cluster}
\input{6-results-m2}

\section{Conclusion}
\label{sec:discussion}
\input{7-discussion}

\bibliographystyle{unsrt}
\bibliography{bibliography}

\appendix
\section{Reparameterized and REINFORCE gradients}
\label{sec:reparam_details}
\input{A1-reparam_details}

\section{Results on Stripe-82}
\label{sec:results_sparse_field}
\input{A2-results-sparse_field}

\section{Sensitivity to prior parameters}
\label{sec:prior_sensitivity}
\input{A3-prior_sensitivity}

% probably won't include these sections anymore
% \section{Results on a test M2 image}
% \input{A4-m2_test_image}

% \input{comparison_w_is}

\end{document}
