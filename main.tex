\documentclass[12pt]{article}
\usepackage{amsmath}
\usepackage{graphicx,psfrag,epsf}
\usepackage{enumerate}
\usepackage{natbib}
\usepackage{url} % not crucial - just used below for the URL
\usepackage{subcaption}
\usepackage{booktabs}
\usepackage{hyperref}
\usepackage{float}
\usepackage{ulem}
%\pdfminorversion=4
% NOTE: To produce blinded version, replace "0" with "1" below.
\newcommand{\blind}{1}

\newcommand{\rulesep}{\unskip\ \vrule\ }

\usepackage{amsfonts}
\usepackage{wrapfig}
\newcommand{\Prob}{P}
\newcommand{\Expect}{\mathbb{E}}
\newcommand{\Reals}{\mathbb{R}}
\newcommand{\KL}{\textrm{KL}}

% DON'T change margins - should be 1 inch all around.
\addtolength{\oddsidemargin}{-.5in}%
\addtolength{\evensidemargin}{-.5in}%
\addtolength{\textwidth}{1in}%
\addtolength{\textheight}{-.3in}%
\addtolength{\topmargin}{-.8in}%

\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}

\usepackage{soul}
\usepackage[disable]{todonotes}
\newcommand{\jeff}[2][]{\todo[inline,color=blue!30, #1]{#2 \mbox{--Jeff}}}
\newcommand{\bryan}[2][]{\todo[inline,color=green!30, #1]{#2 \mbox{--Bryan}}}
 

\begin{document}

%\bibliographystyle{natbib}

\def\spacingset#1{\renewcommand{\baselinestretch}%
{#1}\small\normalsize} \spacingset{1}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Reweighted Wake-Sleep for Deblending Crowded Starfields
\if1\blind
{
  \title{\bf Variational Inference for Deblending Crowded Starfields}
  \author{Runjing Liu\thanks{
    The authors gratefully acknowledge \textit{please remember to list all relevant funding sources in the unblinded version}. NSF graduate research fellowship etc ... }\hspace{.2cm}\\
    Department of Statistics, University of California, Berkeley\\
    \\
    Jeffrey Regier \\
    Department of Statistics, University of Michigan\\
    \\
    Jon D. McAuliffe \\
    The Voleon Group \\
    Department of Statistics, University of California, Berkeley}
  \maketitle
} \fi

\if0\blind
{
  \bigskip
  \bigskip
  \bigskip
  \begin{center}
    {\LARGE\bf A Variational Inference Approach to Deblending Crowded Starfields using the Wake-sleep Algorithm}
\end{center}
  \medskip
} \fi

\bigskip
\begin{abstract}
A key step in the construction of astronomical catalogs is deblending, the task of identifying and characterizing each imaged light source.
In crowded fields, sources often cannot be unambiguously separated. 
Probabilistic cataloging defines a statistical model
on the raw telescope images and captures the uncertainties in catalog construction by the Bayesian posterior.
However, the computational cost of MCMC is prohibitive for the terabytes of data collected by modern astronomical surveys. 
In this work, we propose a method based on amortized variational inference.
A neural network is trained to produce an approximate posterior on catalogs using the wake-sleep algorithm. 
Like variational EM, this algorithm finds approximate posteriors while estimating model parameters such as the point spread function. 
However, the ELBO objective in the E-step of variational EM is replaced by an alternative KL divergence.
In this application, the wake-sleep algorithm is better able to avoid local minima. 
Our algorithm is scalable to large astronomical surveys and provides a statistical framework producing an cataloging pipeline whereby uncertainties are fully propagated from raw image to catalog to downstream analysis. 

\end{abstract}

\noindent%
{\it Keywords:}  Bayesian methods, approximate inference, astronomical surveys, cataloging. 
\vfill

\newpage
\spacingset{1.45} % DON'T change the spacing!
\section{Introduction}
\label{sec:intro}
\input{1-introduction}

\section{The generative model}
\label{sec:gen_model}
\input{2-generative_model}

\section{Variational inference}
\label{sec:var_inference}
\input{3-var_inference}

\section{The wake-sleep algorithm}
\label{sec:wake_sleep}
\input{3b-wake_sleep}
\input{3c-variational_em}
\input{3d-sleep_details}
% NO LONGER NEEDED
% \section{Related work}
% \label{sec:related_work}
% \input{4-related_work}

\section{Results}
\label{sec:results}
\input{5a-results-synth_data}
\input{5b-results-deblending}
\input{5c-results-m2}

\section{Discussion}
\label{sec:discussion}
\input{6-discussion}

TODO fix issues in references. 
\bibliographystyle{unsrt}
\bibliography{bibliography}

\appendix
\section{Reparameterized and REINFORCE gradients}
\label{sec:reparam_details}
\input{A1-reparam_details}

\section{Results on Stripe-82}
\input{A2-results-sparse_field}

\section{Sensitivity to prior parameters}
\input{A3-prior_sensitivity}

% probably won't include these sections anymore
% \section{Results on a test M2 image}
% \input{A4-m2_test_image}

% \input{comparison_w_is}

\end{document}
